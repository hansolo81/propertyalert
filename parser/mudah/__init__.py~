"""parser.fullhouse"""
from lxml import html
import re
from time import strptime
from datetime import date

table_xpath='//form[@name="search_pro_result_form"]'
row_xpath='.//div[@id="search_box"]'

def parse(str_to_parse=""):
    tree = html.fromstring(str_to_parse)
    tbl = tree.xpath(table_xpath)[0]

    for row in tbl.xpath(row_xpath):        
        dt = row.xpath('.//tr/td[4]/br')[0].tail.strip()
        dt = re.search(r'(\d+)-(\w+)-(\d+)', dt)
        dt = date(int('20%s' % dt.group(3)), 
                  strptime(dt.group(2),'%b').tm_mon, 
                  int(dt.group(1)))
        diff = date.today() - dt
        print diff.days

        if diff.days > 2:
            row.getparent().remove(row)

    return html.tostring(tbl)
        

        
    
        
    
